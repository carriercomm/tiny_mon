<% if @health_check_template %>
  <h2><%= t(".new_health_check_from_template", :template => @health_check_template.name) %></h2>
  
  <%= render :partial => "template_form" %>
  <%= render :partial => "preview" if @preview %>
<% elsif params[:template] %>
  <h2><%= t(".new_from_template") %></h2>
  
  <p>
    <%= action_list do |a| %>
      <% a.link_to t(".my_templates"), new_account_site_health_check_path(@account, @site, :template => 'select', :filter => 'mine') %>
      <% a.link_to t(".account_templates"), new_account_site_health_check_path(@account, @site, :template => 'select', :filter => 'account') %>
      <% a.link_to t(".public_templates"), new_account_site_health_check_path(@account, @site, :template => 'select', :filter => 'public') %>
      <% a.link_to t(".all_templates"), new_account_site_health_check_path(@account, @site, :template => 'select', :filter => 'all') %>
    <% end %>
  </p>
  
  <% if @health_check_templates.empty? %>
    <p><%= t(".no_templates_found") %></p>
  <% else %>
    <%= will_paginate @health_check_templates %>
    
    <ul class="asterisk">
      <% @health_check_templates.each do |template| %>
        <li>
          <%= action_list do |a| %>
            <% a.link_to template.name, new_account_site_health_check_path(@account, @site, :template => template.id) %>
            <% a.link_to t(".import"), new_account_site_health_check_import_path(@account, @site, :template => template.id) if current_user.can_create_health_check_imports?(@account) %>
          <% end %><br/>
          <%=h template.description %><br/>
          <%= t(".template_created_by", :user => link_to(template.user.full_name, user_path(template.user))) %>
        </li>
      <% end %>
    </ul>
    
    <%= will_paginate @health_check_templates %>
  <% end %>
  
  <p><%= link_to t(".create_template"), new_health_check_template_path %></p>
<% else %>
  <h2><%= t('.new_health_check_for_site', :site => @site.name) %></h2>
  
  <%= render :partial => "form" %>
<% end %>
